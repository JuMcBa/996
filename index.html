<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Porsche 996 Maintenance Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Ensure touch-friendly tap targets */
        button, input, select {
            min-height: 44px; /* Minimum tap target size for iOS */
            font-size: 16px; /* Minimum font size for readability on iPhone */
        }
        /* Responsive font sizes for headers */
        h1 {
            font-size: 1.5rem; /* 24px on small screens */
        }
        @media (min-width: 640px) {
            h1 {
                font-size: 2.25rem; /* 36px on larger screens */
            }
        }
        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 50;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }
        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 90%;
            max-width: 600px;
            border-radius: 8px;
        }
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
        /* List styles for services */
        .service-list {
            list-style: none;
            padding: 0;
        }
        .service-item {
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 8px 12px;
            margin-bottom: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            transition: transform 0.2s;
            cursor: pointer;
        }
        .service-item:hover {
            transform: translateY(-1px);
        }
        .upcoming-item {
            background-color: #eff6ff; /* Light blue for upcoming */
        }
        .completed-item {
            background-color: #f0fdf4; /* Light green for completed */
        }
        .overdue-item {
            background-color: #fef9c3; /* Yellow for overdue */
        }
        .service-item h3 {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 4px;
        }
        .service-item .description {
            font-size: 0.75rem;
            color: #6b7280;
            margin-bottom: 4px;
        }
        .service-item .details-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4px;
            font-size: 0.75rem;
        }
        .service-item .label {
            font-weight: 500;
            color: #4b5563;
        }
        .service-item .cost {
            font-size: 0.75rem;
            font-weight: 500;
            text-align: right;
            margin-top: 4px;
        }
        /* QR Code Icon */
        .qr-icon {
            width: 24px;
            height: 24px;
            cursor: pointer;
        }
        /* Large QR Code in Modal */
        .qr-code-large {
            width: 200px;
            height: 200px;
            margin: 0 auto;
            display: block;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans">
    <div class="container mx-auto p-4 sm:p-6">
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-3xl font-bold">Porsche 996 Maintenance Tracker</h1>
            <div onclick="openQRModal()">
                <svg class="qr-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7" />
                    <rect x="14" y="3" width="7" height="7" />
                    <rect x="3" y="14" width="7" height="7" />
                    <rect x="14" y="14" width="7" height="7" />
                    <path d="M10 3h4v18h-4z" />
                    <path d="M3 10h18v4H3z" />
                    <path d="M10 10h4v4h-4z" />
                </svg>
            </div>
        </div>

        <!-- QR Code Modal -->
        <div id="qrModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeQRModal()">×</span>
                <h2 class="text-xl font-semibold mb-4 text-center">Scan to Visit</h2>
                <svg class="qr-code-large" viewBox="0 0 100 100" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="10" y="10" width="30" height="30" fill="black"/>
                    <rect x="60" y="10" width="30" height="30" fill="black"/>
                    <rect x="10" y="60" width="30" height="30" fill="black"/>
                    <rect x="60" y="60" width="30" height="30" fill="black"/>
                    <rect x="40" y="40" width="20" height="20" fill="black"/>
                    <!-- Placeholder pattern -->
                    <rect x="45" y="45" width="5" height="5" fill="white"/>
                    <rect x="50" y="50" width="5" height="5" fill="white"/>
                    <rect x="45" y="50" width="5" height="5" fill="white"/>
                    <rect x="50" y="45" width="5" height="5" fill="white"/>
                </svg>
                <p class="text-center mt-4">
                    <a href="https://jumcba.github.io/996/" target="_blank" class="text-blue-500 hover:underline">https://jumcba.github.io/996/</a>
                </p>
            </div>
        </div>

        <!-- Service Details Modal -->
        <div id="serviceDetailsModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeServiceDetailsModal()">×</span>
                <h2 class="text-xl font-semibold mb-4">Service Details</h2>
                <div id="serviceDetailsContent"></div>
                <div class="flex justify-end gap-2 mt-4">
                    <button id="editServiceButton" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Edit</button>
                    <button id="deleteServiceButton" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">Delete</button>
                </div>
            </div>
        </div>

        <!-- Tab Navigation -->
        <div class="mb-4">
            <ul class="flex border-b flex-wrap">
                <li class="mr-1">
                    <button id="maintenanceTab" onclick="openTab('maintenance')" class="bg-white inline-block py-2 px-4 text-blue-500 font-semibold border-l border-t border-r rounded-t text-sm sm:text-base">Maintenance</button>
                </li>
                <li class="mr-1">
                    <button id="valueTab" onclick="openTab('value')" class="bg-gray-200 inline-block py-2 px-4 text-gray-700 font-semibold text-sm sm:text-base">Car Value</button>
                </li>
                <li class="mr-1">
                    <button id="eventsTab" onclick="openTab('events')" class="bg-gray-200 inline-block py-2 px-4 text-gray-700 font-semibold text-sm sm:text-base">Upcoming Events</button>
                </li>
            </ul>
        </div>

        <!-- Maintenance Tab Content -->
        <div id="maintenance" class="tab-content">
            <!-- Mileage Input -->
            <div class="mb-6 p-4 bg-white rounded-lg shadow">
                <h2 class="text-xl font-semibold mb-2">Current Mileage</h2>
                <input id="mileageInput" type="number" value="136000" class="border p-2 rounded w-full mb-2" placeholder="Enter current mileage">
                <button onclick="updateMileage()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 w-full sm:w-auto">Update Mileage</button>
                <p class="mt-2">Current Mileage: <span id="currentMileage">136,000</span> miles</p>
            </div>

            <!-- Add Service Button -->
            <div class="mb-6 p-4 bg-white rounded-lg shadow">
                <button onclick="openAddServiceModal()" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 w-full sm:w-auto">Add Service</button>
            </div>

            <!-- Add Service Modal -->
            <div id="addServiceModal" class="modal">
                <div class="modal-content">
                    <span class="close" onclick="closeAddServiceModal()">×</span>
                    <h2 class="text-xl font-semibold mb-4">Add Service</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div>
                            <label class="block mb-1">Service Status:</label>
                            <select id="serviceStatus" class="border p-2 rounded w-full" onchange="toggleServiceFields()">
                                <option value="upcoming">Upcoming</option>
                                <option value="completed">Completed</option>
                            </select>
                        </div>
                        <div>
                            <label class="block mb-1">Service Type:</label>
                            <select id="serviceType" class="border p-2 rounded w-full">
                                <option value="SERVICE">SERVICE</option>
                                <option value="UPGRADE">UPGRADE</option>
                                <option value="REPAIR">REPAIR</option>
                            </select>
                        </div>
                        <div>
                            <label class="block mb-1">Date:</label>
                            <input id="serviceDate" type="date" class="border p-2 rounded w-full">
                        </div>
                        <div>
                            <label class="block mb-1">Mileage:</label>
                            <input id="serviceMileage" type="number" class="border p-2 rounded w-full" placeholder="Mileage">
                        </div>
                        <div>
                            <label class="block mb-1">Project:</label>
                            <input id="serviceProject" type="text" class="border p-2 rounded w-full" placeholder="Project">
                        </div>
                        <div>
                            <label class="block mb-1">Description:</label>
                            <input id="serviceDescription" type="text" class="border p-2 rounded w-full" placeholder="Description">
                        </div>
                        <div id="upcomingCostField">
                            <label class="block mb-1">Projected Cost:</label>
                            <input id="serviceProjectedCost" type="text" class="border p-2 rounded w-full" placeholder="Projected Cost">
                        </div>
                        <div id="completedCostField" class="hidden">
                            <label class="block mb-1">Actual Cost:</label>
                            <input id="serviceActualCost" type="text" class="border p-2 rounded w-full" placeholder="Actual Cost">
                        </div>
                        <div id="completedVendorField" class="hidden">
                            <label class="block mb-1">Vendor:</label>
                            <input id="serviceVendor" type="text" class="border p-2 rounded w-full" placeholder="Vendor">
                        </div>
                        <div>
                            <label class="block mb-1">Oil Change:</label>
                            <input id="serviceOilChange" type="checkbox" class="h-5 w-5">
                        </div>
                        <div>
                            <label class="block mb-1">Spark Plug:</label>
                            <input id="serviceSparkPlug" type="checkbox" class="h-5 w-5">
                        </div>
                        <div>
                            <label class="block mb-1">Brake Service:</label>
                            <input id="serviceBrake" type="checkbox" class="h-5 w-5">
                        </div>
                    </div>
                    <button onclick="submitService()" class="mt-4 bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 w-full sm:w-auto">Submit Service</button>
                </div>
            </div>

            <!-- Upcoming Services -->
            <div class="mb-6 p-4 bg-white rounded-lg shadow">
                <div class="flex justify-between items-center mb-2">
                    <h2 class="text-xl font-semibold">Upcoming Services</h2>
                    <input id="upcomingSearch" type="text" class="border p-2 rounded w-full sm:w-1/3" placeholder="Search Upcoming Services..." onkeyup="searchListItems('upcomingList', 'upcomingSearch')">
                </div>
                <ul id="upcomingList" class="service-list">
                    <li class="service-item upcoming-item" data-project="Minor Service" data-mileage="136000">
                        <h3>Minor Service</h3>
                        <p class="description">Oil Change, Inspection, Brake Fluid Flush, Coolant Flush, Air Filter</p>
                        <div class="details-grid">
                            <p><span class="label">Type:</span> SERVICE</p>
                            <p><span class="label">Mileage:</span> 136,000</p>
                            <p><span class="label">Date:</span> 2025-05-15</p>
                            <p><span class="label">Miles Remaining:</span> <span class="miles-remaining">0</span></p>
                        </div>
                        <p class="cost">Projected Cost: $1,000</p>
                    </li>
                    <li class="service-item upcoming-item" data-project="IMS Bearing/Clutch Check" data-mileage="136000">
                        <h3>IMS Bearing/Clutch Check</h3>
                        <p class="description">Inspect IMS Bearing, Clutch</p>
                        <div class="details-grid">
                            <p><span class="label">Type:</span> UPGRADE</p>
                            <p><span class="label">Mileage:</span> 136,000</p>
                            <p><span class="label">Date:</span> 2025-05-15</p>
                            <p><span class="label">Miles Remaining:</span> <span class="miles-remaining">0</span></p>
                        </div>
                        <p class="cost">Projected Cost: $500</p>
                    </li>
                    <li class="service-item upcoming-item" data-project="Tire Replacement" data-mileage="136000">
                        <h3>Tire Replacement</h3>
                        <p class="description">Replace Tires</p>
                        <div class="details-grid">
                            <p><span class="label">Type:</span> UPGRADE</p>
                            <p><span class="label">Mileage:</span> 136,000</p>
                            <p><span class="label">Date:</span> 2025-05-15</p>
                            <p><span class="label">Miles Remaining:</span> <span class="miles-remaining">0</span></p>
                        </div>
                        <p class="cost">Projected Cost: $1,200</p>
                    </li>
                    <li class="service-item upcoming-item" data-project="Oil Change" data-mileage="139000">
                        <h3>Oil Change</h3>
                        <p class="description">Oil Change, Inspection</p>
                        <div class="details-grid">
                            <p><span class="label">Type:</span> SERVICE</p>
                            <p><span class="label">Mileage:</span> 139,000</p>
                            <p><span class="label">Date:</span> 2025-08-15</p>
                            <p><span class="label">Miles Remaining:</span> <span class="miles-remaining">3,000</span></p>
                        </div>
                        <p class="cost">Projected Cost: $200</p>
                    </li>
                    <li class="service-item upcoming-item" data-project="Minor Service" data-mileage="144000">
                        <h3>Minor Service</h3>
                        <p class="description">Oil Change, Inspection</p>
                        <div class="details-grid">
                            <p><span class="label">Type:</span> SERVICE</p>
                            <p><span class="label">Mileage:</span> 144,000</p>
                            <p><span class="label">Date:</span> 2025-11-15</p>
                            <p><span class="label">Miles Remaining:</span> <span class="miles-remaining">8,000</span></p>
                        </div>
                        <p class="cost">Projected Cost: $200</p>
                    </li>
                    <li class="service-item upcoming-item" data-project="Major Service" data-mileage="150664">
                        <h3>Major Service</h3>
                        <p class="description">Oil Change, Spark Plugs, Filters, Inspection</p>
                        <div class="details-grid">
                            <p><span class="label">Type:</span> SERVICE</p>
                            <p><span class="label">Mileage:</span> 150,664</p>
                            <p><span class="label">Date:</span> 2026-05-15</p>
                            <p><span class="label">Miles Remaining:</span> <span class="miles-remaining">14,664</span></p>
                        </div>
                        <p class="cost">Projected Cost: $1,500</p>
                    </li>
                    <li class="service-item upcoming-item" data-project="Brake Fluid Flush" data-mileage="151000">
                        <h3>Brake Fluid Flush</h3>
                        <p class="description">Brake Fluid Flush</p>
                        <div class="details-grid">
                            <p><span class="label">Type:</span> SERVICE</p>
                            <p><span class="label">Mileage:</span> 151,000</p>
                            <p><span class="label">Date:</span> 2027-05-15</p>
                            <p><span class="label">Miles Remaining:</span> <span class="miles-remaining">15,000</span></p>
                        </div>
                        <p class="cost">Projected Cost: $300</p>
                    </li>
                    <li class="service-item upcoming-item" data-project="Coolant Flush" data-mileage="162245">
                        <h3>Coolant Flush</h3>
                        <p class="description">Coolant Flush</p>
                        <div class="details-grid">
                            <p><span class="label">Type:</span> SERVICE</p>
                            <p><span class="label">Mileage:</span> 162,245</p>
                            <p><span class="label">Date:</span> 2029-05-15</p>
                            <p><span class="label">Miles Remaining:</span> <span class="miles-remaining">26,245</span></p>
                        </div>
                        <p class="cost">Projected Cost: $400</p>
                    </li>
                    <li class="service-item upcoming-item" data-project="Air Filter/Fuel Filter" data-mileage="162245">
                        <h3>Air Filter/Fuel Filter</h3>
                        <p class="description">Replace Air Filter, Fuel Filter</p>
                        <div class="details-grid">
                            <p><span class="label">Type:</span> SERVICE</p>
                            <p><span class="label">Mileage:</span> 162,245</p>
                            <p><span class="label">Date:</span> 2029-05-15</p>
                            <p><span class="label">Miles Remaining:</span> <span class="miles-remaining">26,245</span></p>
                        </div>
                        <p class="cost">Projected Cost: $300</p>
                    </li>
                    <li class="service-item upcoming-item" data-project="IMS Bearing/Clutch Check" data-mileage="188985">
                        <h3>IMS Bearing/Clutch Check</h3>
                        <p class="description">Inspect IMS Bearing, Clutch</p>
                        <div class="details-grid">
                            <p><span class="label">Type:</span> UPGRADE</p>
                            <p><span class="label">Mileage:</span> 188,985</p>
                            <p><span class="label">Date:</span> 2029-05-15</p>
                            <p><span class="label">Miles Remaining:</span> <span class="miles-remaining">52,985</span></p>
                        </div>
                        <p class="cost">Projected Cost: $500</p>
                    </li>
                </ul>
            </div>

            <!-- Completed Services -->
            <div class="p-4 bg-white rounded-lg shadow">
                <div class="flex justify-between items-center mb-2">
                    <h2 class="text-xl font-semibold">Completed Services</h2>
                    <input id="completedSearch" type="text" class="border p-2 rounded w-full sm:w-1/3" placeholder="Search Completed Services..." onkeyup="searchListItems('completedList', 'completedSearch')">
                </div>
                <ul id="completedList" class="service-list">
                    <!-- Completed services will be populated here -->
                </ul>
            </div>
        </div>

        <!-- Car Value Tab Content -->
        <div id="value" class="tab-content hidden">
            <div class="p-4 bg-white rounded-lg shadow">
                <h2 class="text-xl font-semibold mb-2">Estimate Your Porsche 996's Value</h2>
                <p class="mb-4">Enter your car's details to estimate its current market value based on recent sales data.</p>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-4">
                    <div>
                        <label class="block mb-1">Year:</label>
                        <select id="carYear" class="border p-2 rounded w-full">
                            <option value="1998">1998</option>
                            <option value="1999">1999</option>
                            <option value="2000">2000</option>
                            <option value="2001">2001</option>
                            <option value="2002">2002</option>
                            <option value="2003" selected>2003</option>
                            <option value="2004">2004</option>
                        </select>
                    </div>
                    <div>
                        <label class="block mb-1">Mileage:</label>
                        <input id="carMileage" type="number" value="136000" class="border p-2 rounded w-full" placeholder="Enter mileage">
                    </div>
                    <div>
                        <label class="block mb-1">Condition:</label>
                        <select id="carCondition" class="border p-2 rounded w-full">
                            <option value="poor">Poor</option>
                            <option value="fair">Fair</option>
                            <option value="good" selected>Good</option>
                            <option value="excellent">Excellent</option>
                        </select>
                    </div>
                </div>
                <button onclick="calculateCarValue()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 w-full sm:w-auto">Calculate Value</button>
                <div id="valueResult" class="mt-4">
                    <p>Estimated Value: <span id="estimatedValue">$17,250</span></p>
                    <p class="text-sm text-gray-600">Note: This is an estimate based on recent market data for Porsche 996 Carrera Cabriolets. Actual value may vary depending on specific features, location, and market conditions.</p>
                </div>
            </div>
        </div>

        <!-- Upcoming Events Tab Content -->
        <div id="events" class="tab-content hidden">
            <div class="p-4 bg-white rounded-lg shadow">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold">Upcoming Porsche Events</h2>
                    <button onclick="refreshEvents()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Refresh Events</button>
                </div>
                <p class="mb-4">Porsche car events in the Bay Area and around Carmel, CA, from May 22, 2025, to August 22, 2025.</p>
                <div id="eventsList" class="space-y-4">
                    <div>
                        <h3 class="text-lg font-medium">May 23, 2025 – Fremont, CA</h3>
                        <p><strong>Event:</strong> Friday Night Grill n Chill Cruise Night</p>
                        <p><strong>Description:</strong> A weekly cruise night for car enthusiasts, including Porsche owners, at the Flying A Service Station.</p>
                        <p><strong>Link:</strong> <a href="https://norcalcarculture.com" target="_blank" class="text-blue-500 hover:underline">norcalcarculture.com</a></p>
                    </div>
                    <div>
                        <h3 class="text-lg font-medium">May 24, 2025 – Concord, CA</h3>
                        <p><strong>Event:</strong> Hot Concord Nights Cruise-In</p>
                        <p><strong>Description:</strong> A Saturday evening cruise-in event welcoming all car makes, including Porsches, at Los Tacos de Pancho.</p>
                        <p><strong>Link:</strong> <a href="https://norcalcarculture.com" target="_blank" class="text-blue-500 hover:underline">norcalcarculture.com</a></p>
                    </div>
                    <div>
                        <h3 class="text-lg font-medium">May 25, 2025 – Santa Rosa, CA</h3>
                        <p><strong>Event:</strong> Hot Rods & Burgers</p>
                        <p><strong>Description:</strong> A Sunday event featuring classic cars, including Porsches, at Machado Burgers.</p>
                        <p><strong>Link:</strong> <a href="https://norcalcarculture.com" target="_blank" class="text-blue-500 hover:underline">norcalcarculture.com</a></p>
                    </div>
                    <div>
                        <h3 class="text-lg font-medium">May 25-29, 2025 – Watkins Glen, NY (Co-hosted by Metro NY and Niagara PCA)</h3>
                        <p><strong>Event:</strong> Watkins Glen HPDE (High Performance Drivers Education)</p>
                        <p><strong>Description:</strong> A fully instructed High Performance Drivers Education event at Watkins Glen International, co-hosted by Metro NY and Niagara PCA, offering Bay Area PCA members a chance to participate.</p>
                        <p><strong>Link:</strong> <a href="https://www.pca.org" target="_blank" class="text-blue-500 hover:underline">pca.org</a></p>
                    </div>
                    <div>
                        <h3 class="text-lg font-medium">June 15, 2025 – Santa Cruz, CA</h3>
                        <p><strong>Event:</strong> Forest Bathing in the Redwoods Tour</p>
                        <p><strong>Description:</strong> A tour through the Santa Cruz Mountains' redwoods, inspired by Shinrin-yoku, organized by the Loma Prieta Region PCA, starting in Santa Cruz and ending in Loma Mar.</p>
                        <p><strong>Link:</strong> <a href="https://lprpca.org" target="_blank" class="text-blue-500 hover:underline">lprpca.org</a></p>
                    </div>
                    <div>
                        <h3 class="text-lg font-medium">July 6-12, 2025 – Monterey Bay Region</h3>
                        <p><strong>Event:</strong> 2025 Porsche Parade</p>
                        <p><strong>Description:</strong> The 69th Porsche Parade, a major PCA event, held at the Omni Oklahoma City Hotel, relevant for Monterey Bay Region PCA members to attend or follow.</p>
                        <p><strong>Link:</strong> <a href="https://mby.pca.org" target="_blank" class="text-blue-500 hover:underline">mby.pca.org</a></p>
                    </div>
                    <div>
                        <h3 class="text-lg font-medium">August 15, 2025 – Monterey, CA</h3>
                        <p><strong>Event:</strong> 2025 Werks Reunion Monterey</p>
                        <p><strong>Description:</strong> A significant Porsche event during Monterey Car Week, showcasing a curated selection of Porsches at Monterey Pines Golf Course.</p>
                        <p><strong>Link:</strong> <a href="https://mby.pca.org" target="_blank" class="text-blue-500 hover:underline">mby.pca.org</a></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentMileage = 136000;
        let completedServices = [];
        let upcomingServices = [
            { project: "Minor Service", type: "SERVICE", date: "2025-05-15", mileage: 136000, description: "Oil Change, Inspection, Brake Fluid Flush, Coolant Flush, Air Filter", oilChange: "Yes", sparkPlug: "No", brake: "Yes", cost: "$1,000" },
            { project: "IMS Bearing/Clutch Check", type: "UPGRADE", date: "2025-05-15", mileage: 136000, description: "Inspect IMS Bearing, Clutch", oilChange: "No", sparkPlug: "No", brake: "No", cost: "$500" },
            { project: "Tire Replacement", type: "UPGRADE", date: "2025-05-15", mileage: 136000, description: "Replace Tires", oilChange: "No", sparkPlug: "No", brake: "No", cost: "$1,200" },
            { project: "Oil Change", type: "SERVICE", date: "2025-08-15", mileage: 139000, description: "Oil Change, Inspection", oilChange: "Yes", sparkPlug: "No", brake: "No", cost: "$200" },
            { project: "Minor Service", type: "SERVICE", date: "2025-11-15", mileage: 144000, description: "Oil Change, Inspection", oilChange: "Yes", sparkPlug: "No", brake: "No", cost: "$200" },
            { project: "Major Service", type: "SERVICE", date: "2026-05-15", mileage: 150664, description: "Oil Change, Spark Plugs, Filters, Inspection", oilChange: "Yes", sparkPlug: "Yes", brake: "No", cost: "$1,500" },
            { project: "Brake Fluid Flush", type: "SERVICE", date: "2027-05-15", mileage: 151000, description: "Brake Fluid Flush", oilChange: "No", sparkPlug: "No", brake: "Yes", cost: "$300" },
            { project: "Coolant Flush", type: "SERVICE", date: "2029-05-15", mileage: 162245, description: "Coolant Flush", oilChange: "No", sparkPlug: "No", brake: "No", cost: "$400" },
            { project: "Air Filter/Fuel Filter", type: "SERVICE", date: "2029-05-15", mileage: 162245, description: "Replace Air Filter, Fuel Filter", oilChange: "No", sparkPlug: "No", brake: "No", cost: "$300" },
            { project: "IMS Bearing/Clutch Check", type: "UPGRADE", date: "2029-05-15", mileage: 188985, description: "Inspect IMS Bearing, Clutch", oilChange: "No", sparkPlug: "No", brake: "No", cost: "$500" }
        ];

        // Initialize completed services with data from the previous spreadsheet
        const initialCompletedServices = [
            { date: "2020-05-24", mileage: "97069", project: "Replace Catalytic Converter", description: "Replace Catalytic Converter", cost: "$1,849", vendor: "Makellos Classics" },
            { date: "2018-11-20", mileage: "95534", project: "Lube, Oil and Filter Service", description: "Remove and Replace Secondary Air Components and Check for Fault Codes", cost: "$266", vendor: "Makellos Classics" },
            { date: "2018-11-21", mileage: "95636", project: "Enkei Wheels and P-Zero Tires", description: "Enkei Wheels and P-Zero Tires", cost: "$2,405", vendor: "Makellos Classics" },
            { date: "2018-12-19", mileage: "96115", project: "Replace Starter", description: "Hood Lock Actuator", cost: "$1,082", vendor: "Makellos Classics" },
            { date: "2020-05-24", mileage: "102245", project: "Lube, Oil and Filter Service + New Xenon Light Bulbs", description: "Lube, Oil and Filter Service + New Xenon Light Bulbs", cost: "$585", vendor: "Makellos Classics" },
            { date: "2020-01-30", mileage: "104556", project: "New Rear Tires Cont Extreme Contact Sport", description: "New Rear Tires Cont Extreme Contact Sport", cost: "$688", vendor: "Discount Tire" },
            { date: "2020-02-18", mileage: "105289", project: "Replace Brake Rotors, Pads, Sensors and Hardware", description: "Replace Brake Rotors, Pads, Sensors and Hardware", cost: "$1,239", vendor: "Makellos Classics" },
            { date: "2020-05-14", mileage: "104938", project: "Headlight Switch", description: "Headlight Switch", cost: "$153", vendor: "Makellos Classics" },
            { date: "2021-07-01", mileage: "113000", project: "Replace with Magnaflow Catalytic Converter", description: "Replace with Magnaflow Catalytic Converter", cost: "$411", vendor: "Makellos Classics" },
            { date: "2021-07-06", mileage: "113000", project: "PCCM+ Unit", description: "Replace Shift Knob, Center Console Storage", cost: "$351", vendor: "Suncoastparts.com" },
            { date: "2021-08-29", mileage: "113000", project: "Rebuild Convertible Top Hydraulic Pistons", description: "Rebuild Convertible Top Hydraulic Pistons", cost: "$34", vendor: "N/A" },
            { date: "2021-08-29", mileage: "113000", project: "Leather Interior, Dash, Door Panels, Steering Column Trim, Dash Vents", description: "Leather Interior, Dash, Door Panels, Steering Column Trim, Dash Vents", cost: "$2,810", vendor: "eBay, Pride Auto Wrecking" },
            { date: "2021-10-04", mileage: "113000", project: "996 Turbo Front Bumper Cover with 45 Spoiler Lip", description: "996 Turbo Front Bumper Cover with 45 Spoiler Lip", cost: "$739", vendor: "eBay" },
            { date: "2021-10-11", mileage: "113000", project: "Sport Steering Wheel and Airbag Leather Wrap", description: "Sport Steering Wheel and Airbag Leather Wrap", cost: "$1,300", vendor: "eBay" },
            { date: "2021-10-29", mileage: "113000", project: "Window Tint 70 Front 40 Rear", description: "Window Tint 70 Front 40 Rear", cost: "$800", vendor: "??" },
            { date: "2021-11-11", mileage: "115500", project: "Adapter", description: "PCCM+ Installation", cost: "$1,700", vendor: "topsonline.com" },
            { date: "2022-08-11", mileage: "118068", project: "Refresh Spark Plugs and Coils", description: "Refresh Spark Plugs and Coils", cost: "$300", vendor: "FCP Euro.com" },
            { date: "2023-02-15", mileage: "120664", project: "Oil Change, Mobile 1 OW-40", description: "Oil Change, Mobile 1 OW-40", cost: "$150", vendor: "Self" },
            { date: "2024-10-01", mileage: "128000", project: "Paint Front Bumper and Hood", description: "Paint Front Bumper and Hood", cost: "$3,500", vendor: "TBD" },
            { date: "2024-04-26", mileage: "129876", project: "Porsche Classic Engine Oil SW-50 + Filter", description: "Oil Change, Inspection", cost: "$200", vendor: "Pelican Parts" },
            { date: "2017-08-24", mileage: "83180", project: "Replace O2 Sensor, Oil Pressure Send Unit, Lube, Oil and Filter Service", description: "Replace O2 Sensor, Oil Pressure Send Unit, Lube, Oil and Filter Service", cost: "$1,441", vendor: "Makellos Classics" },
            { date: "2017-10-30", mileage: "84813", project: "New Battery", description: "New Battery", cost: "$229", vendor: "Pep Boys" },
            { date: "2017-11-28", mileage: "85699", project: "Replace Brake Pads and Rotors", description: "Replace Brake Pads and Rotors", cost: "$1,679", vendor: "Makellos Classics" },
            { date: "2018-06-15", mileage: "86922", project: "Lube, Oil and Filter Service, Cab Top Operation, New Key, Remove and Replace Coolant Cover Flange", description: "Lube, Oil and Filter Service, Cab Top Operation, New Key, Remove and Replace Coolant Cover Flange", cost: "$454", vendor: "Makellos Classics" },
            { date: "2018-06-04", mileage: "90424", project: "Replace O2 Sensor, Voltage Regulator, H7 Battery, Battery Bracket", description: "Replace O2 Sensor, Voltage Regulator, H7 Battery, Battery Bracket", cost: "$1,038", vendor: "Makellos Classics" },
            { date: "2015-11-14", mileage: "68985", project: "IMS Bearing w/Oiling Kit, Rear Main Seal, Flywheel, Clutch, Timing Chain Tensioner, Oil and Rear Crank Seal, Oil Separator", description: "IMS Bearing w/Oiling Kit, Rear Main Seal, Flywheel, Clutch, Timing Chain Tensioner, Oil and Rear Crank Seal, Oil Separator", cost: "$6,918", vendor: "Konig Motorsport" },
            { date: "2015-11-17", mileage: "69098", project: "Transmission Oil", description: "Transmission Oil", cost: "$154", vendor: "Konig Motorsport" },
            { date: "2015-12-18", mileage: "69098", project: "Ignition Coil", description: "Ignition Coil", cost: "$463", vendor: "Konig Motorsport" },
            { date: "2016-01-16", mileage: "69098", project: "Replace Engine Harness", description: "Replace Engine Harness", cost: "$1,653", vendor: "Konig Motorsport" },
            { date: "2016-03-24", mileage: "71645", project: "Replace with Factory Clutch and Factory Single Mass Flywheel", description: "Replace with Factory Clutch and Factory Single Mass Flywheel", cost: "$2,029", vendor: "Hoehn Porsche" },
            { date: "2016-04-28", mileage: "72422", project: "Replace Wheel Bearing & CV Boot", description: "Replace Wheel Bearing & CV Boot", cost: "$735", vendor: "Makellos Classics" },
            { date: "2016-06-14", mileage: "74866", project: "Replace Engine Mounts", description: "Replace Engine Mounts", cost: "$520", vendor: "Makellos Classics" },
            { date: "2016-10-17", mileage: "76079", project: "Lube, Oil and Filter Service", description: "Lube, Oil and Filter Service", cost: "$249", vendor: "Makellos Classics" },
            { date: "2016-10-31", mileage: "76337", project: "Replace Steering Lock Assembly", description: "Replace Steering Lock Assembly", cost: "$732", vendor: "Makellos Classics" }
        ];

        // Function to initialize completedServices
        function initializeCompletedServices() {
            try {
                const storedServices = localStorage.getItem('completedServices');
                completedServices = storedServices ? JSON.parse(storedServices) : [];
                if (!completedServices || completedServices.length === 0) {
                    completedServices = initialCompletedServices.sort((a, b) => parseInt(a.mileage) - parseInt(b.mileage));
                    localStorage.setItem('completedServices', JSON.stringify(completedServices));
                }
            } catch (error) {
                console.error('Error initializing completedServices:', error);
                completedServices = initialCompletedServices.sort((a, b) => parseInt(a.mileage) - parseInt(b.mileage));
                localStorage.setItem('completedServices', JSON.stringify(completedServices));
            }
        }

        // Load completed services on page load
        window.onload = function() {
            initializeCompletedServices();
            displayCompletedServices();
            updateUpcomingServices();
            // Check completed services against upcoming services on load
            completedServices.forEach(service => {
                const completedMileage = parseInt(service.mileage);
                const project = service.project;
                const matchingItems = document.querySelectorAll(`#upcomingList .service-item[data-project="${project}"]`);
                matchingItems.forEach(item => {
                    const upcomingMileage = parseInt(item.getAttribute('data-mileage'));
                    if (completedMileage >= upcomingMileage) {
                        item.remove();
                        upcomingServices = upcomingServices.filter(s => s.project !== project || s.mileage > completedMileage);
                    }
                });
            });
            // Set initial tab
            openTab('maintenance');

            // Add click event listeners to service items
            document.querySelectorAll('#upcomingList .service-item').forEach(item => {
                item.addEventListener('click', (e) => {
                    if (!e.target.closest('.actions')) {
                        showServiceDetails(item, 'upcoming');
                    }
                });
            });
        };

        // Tab Navigation
        function openTab(tabName) {
            const tabs = document.getElementsByClassName('tab-content');
            for (let i = 0; i < tabs.length; i++) {
                tabs[i].classList.add('hidden');
            }
            document.getElementById(tabName).classList.remove('hidden');

            const tabButtons = document.querySelectorAll('ul li button');
            tabButtons.forEach(button => {
                button.classList.remove('bg-white', 'text-blue-500');
                button.classList.add('bg-gray-200', 'text-gray-700');
            });
            document.getElementById(`${tabName}Tab`).classList.add('bg-white', 'text-blue-500');
        }

        // QR Code Modal Functions
        function openQRModal() {
            document.getElementById('qrModal').style.display = 'block';
        }

        function closeQRModal() {
            document.getElementById('qrModal').style.display = 'none';
        }

        // Service Details Modal Functions
        function showServiceDetails(item, type) {
            const project = item.getAttribute('data-project');
            const mileage = parseInt(item.getAttribute('data-mileage'));
            let service;
            if (type === 'upcoming') {
                service = upcomingServices.find(s => s.project === project && s.mileage === mileage);
            } else {
                service = completedServices.find(s => s.project === project && s.mileage === mileage);
            }

            if (!service) return;

            const modalContent = document.getElementById('serviceDetailsContent');
            if (type === 'upcoming') {
                const milesRemaining = service.mileage - currentMileage;
                modalContent.innerHTML = `
                    <p><span class="label">Project:</span> ${service.project}</p>
                    <p><span class="label">Type:</span> ${service.type}</p>
                    <p><span class="label">Date:</span> ${service.date}</p>
                    <p><span class="label">Mileage:</span> ${service.mileage.toLocaleString()}</p>
                    <p><span class="label">Miles Remaining:</span> ${milesRemaining.toLocaleString()}</p>
                    <p><span class="label">Description:</span> ${service.description}</p>
                    <p><span class="label">Oil Change:</span> ${service.oilChange}</p>
                    <p><span class="label">Spark Plug:</span> ${service.sparkPlug}</p>
                    <p><span class="label">Brake Service:</span> ${service.brake}</p>
                    <p><span class="label">Projected Cost:</span> ${service.cost}</p>
                `;
            } else {
                modalContent.innerHTML = `
                    <p><span class="label">Project:</span> ${service.project}</p>
                    <p><span class="label">Date:</span> ${service.date}</p>
                    <p><span class="label">Mileage:</span> ${service.mileage.toLocaleString()}</p>
                    <p><span class="label">Description:</span> ${service.description}</p>
                    <p><span class="label">Actual Cost:</span> ${service.cost}</p>
                    <p><span class="label">Vendor:</span> ${service.vendor}</p>
                `;
            }

            document.getElementById('editServiceButton').onclick = () => {
                if (type === 'upcoming') {
                    editUpcomingService(item);
                } else {
                    editCompletedService(completedServices.findIndex(s => s.project === project && s.mileage === mileage));
                }
                closeServiceDetailsModal();
            };
            document.getElementById('deleteServiceButton').onclick = () => {
                if (type === 'upcoming') {
                    removeUpcomingService(project);
                } else {
                    deleteCompletedService(completedServices.findIndex(s => s.project === project && s.mileage === mileage));
                }
                closeServiceDetailsModal();
            };

            document.getElementById('serviceDetailsModal').style.display = 'block';
        }

        function closeServiceDetailsModal() {
            document.getElementById('serviceDetailsModal').style.display = 'none';
        }

        // Modal Functions for Add Service
        function openAddServiceModal() {
            document.getElementById('addServiceModal').style.display = 'block';
        }

        function closeAddServiceModal() {
            document.getElementById('addServiceModal').style.display = 'none';
            // Clear form inputs
            document.getElementById('serviceStatus').value = 'upcoming';
            document.getElementById('serviceType').value = 'SERVICE';
            document.getElementById('serviceDate').value = '';
            document.getElementById('serviceMileage').value = '';
            document.getElementById('serviceProject').value = '';
            document.getElementById('serviceDescription').value = '';
            document.getElementById('serviceProjectedCost').value = '';
            document.getElementById('serviceActualCost').value = '';
            document.getElementById('serviceVendor').value = '';
            document.getElementById('serviceOilChange').checked = false;
            document.getElementById('serviceSparkPlug').checked = false;
            document.getElementById('serviceBrake').checked = false;
            toggleServiceFields();
        }

        function toggleServiceFields() {
            const status = document.getElementById('serviceStatus').value;
            const upcomingCostField = document.getElementById('upcomingCostField');
            const completedCostField = document.getElementById('completedCostField');
            const completedVendorField = document.getElementById('completedVendorField');
            const oilChangeField = document.getElementById('serviceOilChange').parentElement;
            const sparkPlugField = document.getElementById('serviceSparkPlug').parentElement;
            const brakeField = document.getElementById('serviceBrake').parentElement;

            if (status === 'upcoming') {
                upcomingCostField.classList.remove('hidden');
                completedCostField.classList.add('hidden');
                completedVendorField.classList.add('hidden');
                oilChangeField.classList.remove('hidden');
                sparkPlugField.classList.remove('hidden');
                brakeField.classList.remove('hidden');
            } else {
                upcomingCostField.classList.add('hidden');
                completedCostField.classList.remove('hidden');
                completedVendorField.classList.remove('hidden');
                oilChangeField.classList.add('hidden');
                sparkPlugField.classList.add('hidden');
                brakeField.classList.add('hidden');
            }
        }

        function submitService() {
            const status = document.getElementById('serviceStatus').value;
            const type = document.getElementById('serviceType').value;
            const date = document.getElementById('serviceDate').value;
            const mileage = document.getElementById('serviceMileage').value;
            const project = document.getElementById('serviceProject').value;
            const description = document.getElementById('serviceDescription').value;
            const oilChange = document.getElementById('serviceOilChange').checked ? 'Yes' : 'No';
            const sparkPlug = document.getElementById('serviceSparkPlug').checked ? 'Yes' : 'No';
            const brake = document.getElementById('serviceBrake').checked ? 'Yes' : 'No';
            const projectedCost = document.getElementById('serviceProjectedCost').value;
            const actualCost = document.getElementById('serviceActualCost').value;
            const vendor = document.getElementById('serviceVendor').value;

            if (status === 'upcoming') {
                if (type && date && mileage && project && description && projectedCost) {
                    upcomingServices.push({
                        project,
                        type,
                        date,
                        mileage: parseInt(mileage),
                        description,
                        oilChange,
                        sparkPlug,
                        brake,
                        cost: projectedCost
                    });
                    displayUpcomingServices();
                    closeAddServiceModal();
                } else {
                    alert('Please fill in all required fields for upcoming services.');
                }
            } else {
                if (date && mileage && project && description && actualCost && vendor) {
                    const service = { date, mileage: parseInt(mileage), project, description, cost: actualCost, vendor };
                    completedServices.push(service);
                    localStorage.setItem('completedServices', JSON.stringify(completedServices));
                    displayCompletedServices();

                    // Check if the completed service matches any upcoming service
                    const completedMileage = parseInt(mileage);
                    const matchingItems = document.querySelectorAll(`#upcomingList .service-item[data-project="${project}"]`);
                    matchingItems.forEach(item => {
                        const upcomingMileage = parseInt(item.getAttribute('data-mileage'));
                        if (completedMileage >= upcomingMileage) {
                            item.remove();
                            upcomingServices = upcomingServices.filter(s => s.project !== project || s.mileage > completedMileage);
                        }
                    });

                    closeAddServiceModal();
                } else {
                    alert('Please fill in all required fields for completed services.');
                }
            }
        }

        // Search Functionality for List Items
        function searchListItems(listId, searchInputId) {
            const searchInput = document.getElementById(searchInputId).value.toLowerCase();
            const list = document.getElementById(listId);
            const items = list.getElementsByClassName('service-item');

            for (let i = 0; i < items.length; i++) {
                const item = items[i];
                const text = item.textContent.toLowerCase();
                if (text.includes(searchInput)) {
                    item.style.display = '';
                } else {
                    item.style.display = 'none';
                }
            }
        }

        function updateMileage() {
            const mileageInput = document.getElementById('mileageInput').value;
            if (mileageInput && !isNaN(mileageInput) && mileageInput >= 0) {
                currentMileage = parseInt(mileageInput);
                document.getElementById('currentMileage').textContent = currentMileage.toLocaleString();
                updateUpcomingServices();
            } else {
                alert('Please enter a valid mileage.');
            }
        }

        function updateUpcomingServices() {
            const list = document.getElementById('upcomingList');
            const items = Array.from(list.getElementsByClassName('service-item'));

            items.forEach(item => {
                const mileage = parseInt(item.getAttribute('data-mileage'));
                const milesRemaining = mileage - currentMileage;
                item.querySelector('.miles-remaining').textContent = milesRemaining.toLocaleString();
                if (currentMileage >= mileage) {
                    item.classList.add('overdue-item');
                } else {
                    item.classList.remove('overdue-item');
                }
            });
        }

        function displayUpcomingServices() {
            const list = document.getElementById('upcomingList');
            list.innerHTML = '';
            upcomingServices.sort((a, b) => a.mileage - b.mileage).forEach(service => {
                const milesRemaining = service.mileage - currentMileage;
                const item = document.createElement('li');
                item.classList.add('service-item', 'upcoming-item');
                item.setAttribute('data-project', service.project);
                item.setAttribute('data-mileage', service.mileage);
                item.innerHTML = `
                    <h3>${service.project}</h3>
                    <p class="description">${service.description}</p>
                    <div class="details-grid">
                        <p><span class="label">Type:</span> ${service.type}</p>
                        <p><span class="label">Mileage:</span> ${service.mileage.toLocaleString()}</p>
                        <p><span class="label">Date:</span> ${service.date}</p>
                        <p><span class="label">Miles Remaining:</span> <span class="miles-remaining">${milesRemaining.toLocaleString()}</span></p>
                    </div>
                    <p class="cost">Projected Cost: ${service.cost}</p>
                `;
                item.addEventListener('click', (e) => {
                    if (!e.target.closest('.actions')) {
                        showServiceDetails(item, 'upcoming');
                    }
                });
                list.appendChild(item);
            });
            updateUpcomingServices();
        }

        function editUpcomingService(item) {
            const project = item.getAttribute('data-project');
            const mileage = parseInt(item.getAttribute('data-mileage'));
            const service = upcomingServices.find(s => s.project === project && s.mileage === mileage);
            if (!service) return;

            const newType = prompt("Edit Type:", service.type);
            const newDate = prompt("Edit Date (YYYY-MM-DD):", service.date);
            const newMileage = prompt("Edit Mileage:", service.mileage);
            const newProject = prompt("Edit Project:", service.project);
            const newDescription = prompt("Edit Description:", service.description);
            const newOilChange = prompt("Edit Oil Change (Yes/No):", service.oilChange);
            const newSparkPlug = prompt("Edit Spark Plug (Yes/No):", service.sparkPlug);
            const newBrake = prompt("Edit Brake (Yes/No):", service.brake);
            const newCost = prompt("Edit Projected Cost:", service.cost);

            if (newType && newDate && newMileage && newProject && newDescription && newOilChange && newSparkPlug && newBrake && newCost) {
                const index = upcomingServices.findIndex(s => s.project === project && s.mileage === mileage);
                upcomingServices[index] = {
                    project: newProject,
                    type: newType,
                    date: newDate,
                    mileage: parseInt(newMileage),
                    description: newDescription,
                    oilChange: newOilChange,
                    sparkPlug: newSparkPlug,
                    brake: newBrake,
                    cost: newCost
                };
                displayUpcomingServices();
            } else {
                alert('All fields are required.');
            }
        }

        function removeUpcomingService(project) {
            upcomingServices = upcomingServices.filter(s => s.project !== project);
            displayUpcomingServices();
        }

        function editCompletedService(index) {
            const service = completedServices[index];
            const date = prompt("Edit Date (YYYY-MM-DD):", service.date);
            const mileage = prompt("Edit Mileage:", service.mileage);
            const project = prompt("Edit Project:", service.project);
            const description = prompt("Edit Description:", service.description);
            const cost = prompt("Edit Actual Cost:", service.cost);
            const vendor = prompt("Edit Vendor:", service.vendor);

            if (date && mileage && project && description && cost && vendor) {
                completedServices[index] = { date, mileage: parseInt(mileage), project, description, cost, vendor };
                localStorage.setItem('completedServices', JSON.stringify(completedServices));
                displayCompletedServices();

                // Check if the updated completed service matches any upcoming service
                const completedMileage = parseInt(mileage);
                const matchingItems = document.querySelectorAll(`#upcomingList .service-item[data-project="${project}"]`);
                matchingItems.forEach(item => {
                    const upcomingMileage = parseInt(item.getAttribute('data-mileage'));
                    if (completedMileage >= upcomingMileage) {
                        item.remove();
                        upcomingServices = upcomingServices.filter(s => s.project !== project || s.mileage > completedMileage);
                    }
                });
            } else {
                alert('All fields are required.');
            }
        }

        function deleteCompletedService(index) {
            if (confirm('Are you sure you want to delete this completed service?')) {
                completedServices.splice(index, 1);
                localStorage.setItem('completedServices', JSON.stringify(completedServices));
                displayCompletedServices();
            }
        }

        function displayCompletedServices() {
            const list = document.getElementById('completedList');
            list.innerHTML = '';
            completedServices.sort((a, b) => a.mileage - b.mileage).forEach((service, index) => {
                const item = document.createElement('li');
                item.classList.add('service-item', 'completed-item');
                item.setAttribute('data-project', service.project);
                item.setAttribute('data-mileage', service.mileage);
                item.innerHTML = `
                    <h3>${service.project}</h3>
                    <p class="description">${service.description}</p>
                    <div class="details-grid">
                        <p><span class="label">Date:</span> ${service.date}</p>
                        <p><span class="label">Mileage:</span> ${service.mileage.toLocaleString()}</p>
                        <p><span class="label">Vendor:</span> ${service.vendor}</p>
                        <p></p>
                    </div>
                    <p class="cost">Actual Cost: ${service.cost}</p>
                `;
                item.addEventListener('click', (e) => {
                    if (!e.target.closest('.actions')) {
                        showServiceDetails(item, 'completed');
                    }
                });
                list.appendChild(item);
            });
        }

        function calculateCarValue() {
            const year = parseInt(document.getElementById('carYear').value);
            const mileage = parseInt(document.getElementById('carMileage').value);
            const condition = document.getElementById('carCondition').value;

            // Base value for a high-mileage Carrera Cabriolet (adjusted for inflation to 2025)
            let baseValue = 18053; // $17,000 in 2023, adjusted for 3% annual inflation to 2025

            // Year adjustment: 996.2 models (2002-2004) are more desirable
            let yearAdjustment = 0;
            if (year >= 2002) {
                yearAdjustment = 1000; // Add $1,000 for 996.2 models
            }

            // Mileage adjustment: Deduct $500 for every 10,000 miles over 60,000
            let mileageAdjustment = 0;
            if (mileage > 60000) {
                const excessMiles = mileage - 60000;
                mileageAdjustment = -Math.floor(excessMiles / 10000) * 500;
            }

            // Condition adjustment
            let conditionAdjustment = 0;
            switch (condition) {
                case 'poor':
                    conditionAdjustment = -3000;
                    break;
                case 'fair':
                    conditionAdjustment = -1000;
                    break;
                case 'good':
                    conditionAdjustment = 2000; // Assumes IMS bearing retrofit and good maintenance
                    break;
                case 'excellent':
                    conditionAdjustment = 4000;
                    break;
            }

            // Calculate total value
            let estimatedValue = baseValue + yearAdjustment + mileageAdjustment + conditionAdjustment;
            if (estimatedValue < 10000) estimatedValue = 10000; // Minimum value for a running 996

            // Display the result
            document.getElementById('estimatedValue').textContent = `$${estimatedValue.toLocaleString()}`;
        }

        // Refresh Events Function
        function refreshEvents() {
            const eventsList = document.getElementById('eventsList');
            eventsList.innerHTML = `
                <div>
                    <h3 class="text-lg font-medium">May 23, 2025 – Fremont, CA</h3>
                    <p><strong>Event:</strong> Friday Night Grill n Chill Cruise Night</p>
                    <p><strong>Description:</strong> A weekly cruise night for car enthusiasts, including Porsche owners, at the Flying A Service Station.</p>
                    <p><strong>Link:</strong> <a href="https://norcalcarculture.com" target="_blank" class="text-blue-500 hover:underline">norcalcarculture.com</a></p>
                </div>
                <div>
                    <h3 class="text-lg font-medium">May 24, 2025 – Concord, CA</h3>
                    <p><strong>Event:</strong> Hot Concord Nights Cruise-In</p>
                    <p><strong>Description:</strong> A Saturday evening cruise-in event welcoming all car makes, including Porsches, at Los Tacos de Pancho.</p>
                    <p><strong>Link:</strong> <a href="https://norcalcarculture.com" target="_blank" class="text-blue-500 hover:underline">norcalcarculture.com</a></p>
                </div>
                <div>
                    <h3 class="text-lg font-medium">May 25, 2025 – Santa Rosa, CA</h3>
                    <p><strong>Event:</strong> Hot Rods & Burgers</p>
                    <p><strong>Description:</strong> A Sunday event featuring classic cars, including Porsches, at Machado Burgers.</p>
                    <p><strong>Link:</strong> <a href="https://norcalcarculture.com" target="_blank" class="text-blue-500 hover:underline">norcalcarculture.com</a></p>
                </div>
                <div>
                    <h3 class="text-lg font-medium">May 25-29, 2025 – Watkins Glen, NY (Co-hosted by Metro NY and Niagara PCA)</h3>
                    <p><strong>Event:</strong> Watkins Glen HPDE (High Performance Drivers Education)</p>
                    <p><strong>Description:</strong> A fully instructed High Performance Drivers Education event at Watkins Glen International, co-hosted by Metro NY and Niagara PCA, offering Bay Area PCA members a chance to participate.</p>
                    <p><strong>Link:</strong> <a href="https://www.pca.org" target="_blank" class="text-blue-500 hover:underline">pca.org</a></p>
                </div>
                <div>
                    <h3 class="text-lg font-medium">June 15, 2025 – Santa Cruz, CA</h3>
                    <p><strong>Event:</strong> Forest Bathing in the Redwoods Tour</p>
                    <p><strong>Description:</strong> A tour through the Santa Cruz Mountains' redwoods, inspired by Shinrin-yoku, organized by the Loma Prieta Region PCA, starting in Santa Cruz and ending in Loma Mar.</p>
                    <p><strong>Link:</strong> <a href="https://lprpca.org" target="_blank" class="text-blue-500 hover:underline">lprpca.org</a></p>
                </div>
                <div>
                    <h3 class="text-lg font-medium">July 6-12, 2025 – Monterey Bay Region</h3>
                    <p><strong>Event:</strong> 2025 Porsche Parade</p>
                    <p><strong>Description:</strong> The 69th Porsche Parade, a major PCA event, held at the Omni Oklahoma City Hotel, relevant for Monterey Bay Region PCA members to attend or follow.</p>
                    <p><strong>Link:</strong> <a href="https://mby.pca.org" target="_blank" class="text-blue-500 hover:underline">mby.pca.org</a></p>
                </div>
                <div>
                    <h3 class="text-lg font-medium">August 15, 2025 – Monterey, CA</h3>
                    <p><strong>Event:</strong> 2025 Werks Reunion Monterey</p>
                    <p><strong>Description:</strong> A significant Porsche event during Monterey Car Week, showcasing a curated selection of Porsches at Monterey Pines Golf Course.</p>
                    <p><strong>Link:</strong> <a href="https://mby.pca.org" target="_blank" class="text-blue-500 hover:underline">mby.pca.org</a></p>
                </div>
            `;
        }
    </script>
</body>
</html>
